{"version":3,"file":"index.min.js","sources":["../../src/index.js"],"sourcesContent":["import \"./style.scss\";\n\nfunction loadResource(url, type, callback) {\n    // 检查是否已经加载过相同的文件\n    var tags = document.getElementsByTagName(type);\n    var alreadyLoaded = false;\n    for (var i = 0; i < tags.length; i++) {\n        if (tags[i].getAttribute('href') === url || tags[i].getAttribute('src') === url) {\n        alreadyLoaded = true;\n        break;\n        }\n    }\n\n    if (!alreadyLoaded) {\n        var tag;\n        if (type === 'script') {\n            tag = document.createElement('script');\n            tag.type = 'text/javascript';\n            tag.src = url;\n        } else if (type === 'link') {\n            tag = document.createElement('link');\n            tag.rel = 'stylesheet';\n            tag.type = 'text/css';\n            tag.href = url;\n        }\n\n        if (tag.readyState) {  // For IE\n            tag.onreadystatechange = function() {\n                if (tag.readyState === 'loaded' || tag.readyState === 'complete') {\n                    tag.onreadystatechange = null;\n                    callback && callback();\n                }\n            };\n        } else {  // Other browsers\n            tag.onload = function() {\n                callback && callback();\n            };\n        }\n\n        document.head.appendChild(tag);\n    } else {\n        callback && callback();\n    }\n}\n\n// // 例如加载一个名为 \"example.js\" 的 JavaScript 文件\n// loadResource('example.js', 'script', function() {\n//     console.log('JavaScript 文件加载完成！');\n// });\n\n// // 例如加载一个名为 \"styles.css\" 的 CSS 文件\n// loadResource('styles.css', 'link', function() {\n//     console.log('CSS 文件加载完成！');\n// });\n\nexport function docsifyXmind(hook, vm) {\n    var count = 0;\n\n    function loadXmindResource(callback) {\n        loadResource('https://xmindltd.github.io/xmind-embed-viewer/xmind-embed-viewer.js', 'script', callback);\n    }\n    loadXmindResource();\n\n    hook.afterEach(function (html, next) {\n        var parser = new DOMParser();\n        var doc = parser.parseFromString(html, \"text/html\");\n\n        // Scans page and adds demo tags\n        var pre_list = doc.querySelectorAll(\"pre\");\n        var pre_array = [...pre_list];\n\n        pre_array.forEach((element) => {\n            //Handles Copy Button\n            var codeId = \"xmind_box_\" + count;\n\n            //Adds in xmind preview\n            if (element.getAttribute(\"data-lang\") == \"xmind preview\") {\n                // 这个就是xmind的链接内容\n                var data = element.innerText;\n                console.info(\"link:\" + data);\n\n                var content = element.outerHTML;\n\n                // 1. 加载javascript\n                // 2. 初始化xmind\n                // 3. 加载xmind文件\n\n                //Creates xmind\n                var xmind = document.createElement(\"div\");\n                xmind.innerHTML = `\n                        <div class=\"xmind\" id=\"${codeId}\" >\n                            <div class=\"xmind_preview\" data-href=\"${data}\">\n                                <div class=\"loading-xmind-overlay\">\n                                    <svg t=\"1703331194570\" class=\"icon\" viewBox=\"0 0 1124 1124\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"4276\" width=\"70\" height=\"70\">\n                                        <path d=\"M876.864 782.592c3.264 0 6.272-3.2 6.272-6.656 0-3.456-3.008-6.592-6.272-6.592-3.264 0-6.272 3.2-6.272 6.592 0 3.456 3.008 6.656 6.272 6.656z m-140.544 153.344c2.304 2.432 5.568 3.84 8.768 3.84a12.16 12.16 0 0 0 8.832-3.84 13.76 13.76 0 0 0 0-18.56 12.224 12.224 0 0 0-8.832-3.84 12.16 12.16 0 0 0-8.768 3.84 13.696 13.696 0 0 0 0 18.56zM552.32 1018.24c3.456 3.648 8.32 5.76 13.184 5.76a18.368 18.368 0 0 0 13.184-5.76 20.608 20.608 0 0 0 0-27.968 18.368 18.368 0 0 0-13.184-5.824 18.368 18.368 0 0 0-13.184 5.76 20.608 20.608 0 0 0 0 28.032z m-198.336-5.76c4.608 4.8 11.072 7.68 17.6 7.68a24.448 24.448 0 0 0 17.536-7.68 27.456 27.456 0 0 0 0-37.248 24.448 24.448 0 0 0-17.536-7.68 24.448 24.448 0 0 0-17.6 7.68 27.52 27.52 0 0 0 0 37.184z m-175.68-91.84c5.76 6.08 13.824 9.6 21.952 9.6a30.592 30.592 0 0 0 22.016-9.6 34.368 34.368 0 0 0 0-46.592 30.592 30.592 0 0 0-22.016-9.6 30.592 30.592 0 0 0-21.952 9.6 34.368 34.368 0 0 0 0 46.592z m-121.152-159.36c6.912 7.36 16.64 11.648 26.368 11.648a36.736 36.736 0 0 0 26.432-11.584 41.28 41.28 0 0 0 0-55.936 36.736 36.736 0 0 0-26.432-11.584 36.8 36.8 0 0 0-26.368 11.52 41.28 41.28 0 0 0 0 56zM12.736 564.672a42.88 42.88 0 0 0 30.784 13.44 42.88 42.88 0 0 0 30.784-13.44 48.128 48.128 0 0 0 0-65.216 42.88 42.88 0 0 0-30.72-13.44 42.88 42.88 0 0 0-30.848 13.44 48.128 48.128 0 0 0 0 65.216z m39.808-195.392a48.96 48.96 0 0 0 35.2 15.36 48.96 48.96 0 0 0 35.2-15.36 54.976 54.976 0 0 0 0-74.56 48.96 48.96 0 0 0-35.2-15.424 48.96 48.96 0 0 0-35.2 15.424 54.976 54.976 0 0 0 0 74.56zM168.32 212.48c10.368 11.008 24.96 17.408 39.68 17.408 14.592 0 29.184-6.4 39.552-17.408a61.888 61.888 0 0 0 0-83.84 55.104 55.104 0 0 0-39.616-17.408c-14.656 0-29.248 6.4-39.616 17.408a61.888 61.888 0 0 0 0 83.84zM337.344 124.8c11.52 12.16 27.712 19.264 43.968 19.264 16.256 0 32.448-7.04 43.968-19.264a68.672 68.672 0 0 0 0-93.184 61.248 61.248 0 0 0-43.968-19.264 61.248 61.248 0 0 0-43.968 19.264 68.736 68.736 0 0 0 0 93.184z m189.632-1.088c12.672 13.44 30.528 21.248 48.448 21.248s35.712-7.808 48.384-21.248a75.584 75.584 0 0 0 0-102.464A67.392 67.392 0 0 0 575.36 0c-17.92 0-35.776 7.808-48.448 21.248a75.584 75.584 0 0 0 0 102.464z m173.824 86.592c13.824 14.592 33.28 23.104 52.736 23.104 19.584 0 39.04-8.512 52.8-23.104a82.432 82.432 0 0 0 0-111.744 73.472 73.472 0 0 0-52.8-23.168c-19.52 0-38.912 8.512-52.736 23.168a82.432 82.432 0 0 0 0 111.744z m124.032 158.528c14.976 15.872 36.032 25.088 57.216 25.088 21.12 0 42.24-9.216 57.152-25.088a89.344 89.344 0 0 0 0-121.088 79.616 79.616 0 0 0-57.152-25.088c-21.184 0-42.24 9.216-57.216 25.088a89.344 89.344 0 0 0 0 121.088z m50.432 204.032c16.128 17.088 38.784 27.008 61.632 27.008 22.784 0 45.44-9.92 61.568-27.008a96.256 96.256 0 0 0 0-130.432 85.76 85.76 0 0 0-61.568-27.072c-22.848 0-45.44 9.984-61.632 27.072a96.192 96.192 0 0 0 0 130.432z\" fill=\"#262626\" p-id=\"4277\">\n                                            <animateTransform attributeName=\"transform\" type=\"rotate\" from=\"0 562 562\" to=\"360 562 562\" dur=\"2s\" repeatCount=\"indefinite\"/>\n                                        </path>\n                                        <text x=\"260\" y=\"640\" style=\"font:italic 220px serif\">Xmind</text>\n                                    </svg>\n                                </div>\n                            </div>\n                            <div class=\"demo_code\" >\n                                ${data}\n                            </div>\n                        </div>\n                    `.trim();\n                    xmind = xmind.firstChild;\n\n                element.replaceWith(xmind);\n            }\n\n            //Updates id count\n            count++;\n        });\n\n        next(doc.body.innerHTML);\n    });\n\n    hook.doneEach(function () {\n        const callback = () => {\n            if (window.XMindEmbedViewer) {\n                let xmindDoms = document.querySelectorAll(\".xmind_preview\");\n                for (const xmindDom of xmindDoms) {\n                    const xmindHref = xmindDom.getAttribute(\"data-href\");\n                    const viewer = new XMindEmbedViewer({\n                        el: xmindDom, // HTMLElement | HTMLIFrameElement | string\n                        // 如果在中国大陆境内速度慢，可以添加的参数 `region: 'cn'` 改为使用 xmind.cn 的图库作为依赖。\n                        region: 'cn', //optinal, global(default) or cn\n                        style: {\n                            \"height\": \"888px\"\n                        }\n                    })\n                    viewer.addEventListener('sheets-load', () => {\n                        // 移除加载层\n                        const loadingOverlay = document.querySelector('.loading-xmind-overlay');\n                        if (loadingOverlay) {\n                            loadingOverlay.parentNode.removeChild(loadingOverlay);\n                        }\n                    })\n\n                    fetch(xmindHref)\n                        .then(res => res.arrayBuffer())\n                        .then(file => viewer.load(file))   \n                }\n            } else {\n                setTimeout(callback, 1000);\n            }\n        }\n        loadXmindResource(callback);\n    });\n}\n\n// Adds plugin\nif (!window.$docsify) {\n    throw new Error(\"Docsify is not loaded\");\n} else {\n    window.$docsify.plugins = [].concat(\n        docsifyXmind,\n        window.$docsify.plugins || []\n    );\n}\n"],"names":["url","type","callback","document","getElementsByTagName","alreadyLoaded","i","tags","length","getAttribute","tag","createElement","src","rel","href","readyState","onreadystatechange","onload","head","appendChild","hook","vm","count","loadResource","loadXmindResource","afterEach","html","next","DOMParser","doc","parser","parseFromString","pre_list","querySelectorAll","pre_array","_toConsumableArray","forEach","element","data","innerText","console","info","outerHTML","xmind","innerHTML","concat","codeId","trim","firstChild","replaceWith","body","doneEach","window","XMindEmbedViewer","xmindDoms","_iterator","_createForOfIteratorHelper","_step","_loop","xmindDom","value","xmindHref","viewer","el","region","style","addEventListener","loadingOverlay","querySelector","parentNode","removeChild","fetch","then","res","arrayBuffer","file","load","s","n","done","err","e","f","$docsify","plugins","docsifyXmind"],"mappings":";;qRAEA,WAAsBA,EAAKC,EAAMC,EAAU,CAIvC,OAFWC,GAAAA,SAASC,qBAAqBH,GACrCI,EAAgB,GACXC,EAAI,EAAGA,EAAIC,EAAKC,OAAQF,IAC7B,GAAIC,EAAKD,GAAGG,aAAa,UAAYT,GAAOO,EAAKD,GAAGG,aAAa,SAAWT,EAAK,CACjFK,EAAgB,GAChB,MAIJ,GAAKA,EA4BDH,GAAYA,QA5BI,CAChB,GACA,GAAID,IAAS,SACTS,GAAMP,SAASQ,cAAc,UAC7BD,EAAIT,KAAO,kBACXS,EAAIE,IAAMZ,GACHC,IAAS,QACVE,GAAAA,SAASQ,cAAc,QAC7BD,EAAIG,IAAM,aACVH,EAAIT,KAAO,WACXS,EAAII,KAAOd,GAGf,EAAQe,WACJL,EAAIM,mBAAqB,UAAW,CAC5BN,GAAIK,aAAe,UAAYL,EAAIK,aAAe,aAC9CC,GAAAA,mBAAqB,KACzBd,GAAYA,MAIpBQ,EAAIO,OAAS,UAAW,CACpBf,GAAYA,KAIpBC,SAASe,KAAKC,YAAYT,eAgBLU,EAAMC,EAAI,CACnC,GAAIC,GAAQ,EAEZ,WAA2BpB,EAAU,CACjCqB,EAAa,sEAAuE,SAAUrB,GAElGsB,IAEAJ,EAAKK,UAAU,SAAUC,EAAMC,EAAM,CACjC,MAAa,GAAIC,WACbC,EAAMC,EAAOC,gBAAgBL,EAAM,aAGnCM,EAAWH,EAAII,iBAAiB,OAChCC,EAASC,EAAOH,GAEpBE,EAAUE,QAAQ,SAACC,EAAY,CAE3B,MAAa,aAAef,EAG5B,GAAIe,EAAQ5B,aAAa,cAAgB,gBAAiB,CAEtD,GAAI6B,GAAOD,EAAQE,UACnBC,QAAQC,KAAK,QAAUH,GAETD,EAAQK,UAOlBC,GAAAA,GAAQxC,SAASQ,cAAc,OACnCgC,EAAMC,UAAY;AAAA,iDAAAC,OACeC,EAAMD;AAAAA,qEAAAA,OACaP;;;;;;;;;;;mCAAIO,OAWtCP,EAGZS;AAAAA;AAAAA;AAAAA,uBAAAA,OACFJ,EAAQA,EAAMK,WAElBX,EAAQY,YAAYN,GAIxBrB,MAGJK,EAAKE,EAAIqB,KAAKN,aAGlBxB,EAAK+B,SAAS,UAAY,CACtB,GAAMjD,GAAW,YAAM,CACnB,GAAIkD,OAAOC,iBAAkB,CACzB,GAAIC,GAAYnD,SAAS8B,iBAAiB,kBAAkBsB,EAAAC,EACrCF,GAASG,EAAA,GAAA,CAAA,GAAAC,GAAAA,UAAE,CAAA,GAAvBC,GAAQF,EAAAG,MACTC,EAAYF,EAASlD,aAAa,aAClCqD,EAAS,GAAqB,kBAAA,CAChCC,GAAIJ,EAEJK,OAAQ,KACRC,MAAO,CACH,OAAU,WAGlBH,EAAOI,iBAAiB,cAAe,UAAM,CAEzC,GAAMC,GAAiBhE,SAASiE,cAAc,0BAC1CD,GACAA,EAAeE,WAAWC,YAAYH,KAI9CI,MAAMV,GACDW,KAAK,SAAAC,EAAG,CAAA,MAAQC,GAAAA,gBAChBF,KAAK,SAAAG,EAAI,CAAA,MAAIb,GAAOc,KAAKD,MApBlC,IAAApB,EAAAsB,IAAApB,CAAAA,GAAAF,EAAAuB,KAAAC,MAAArB,UAqBCsB,EArBDtB,CAqBCH,EAAA0B,EAAAD,UAAA,CAAAzB,EAAA2B,SAEUhF,YAAAA,EAAU,MAG7BsB,EAAkBtB,KAK1B,GAAKkD,OAAO+B,SAGR/B,OAAO+B,SAASC,QAAU,GAAGvC,OACzBwC,EACAjC,OAAO+B,SAASC,SAAW,QAJ/B,UAAgB,OAAA"}